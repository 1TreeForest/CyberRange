<!doctype html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <title>.</title>
</head>
<body>


<script>
const API = 'https://api-new-mp.nvnrnyt.cn'

ajax({
    url : `${API}/api/url`,
    data: {
        type: 2,
        s: query('s')
    },
    method: 'get',
    success: res => {
        location.href = res.data.url
    }
})

function query(variable) {
    var query = window.location.search.substring(1);
    var params = query.split('&');
    for (var i = 0; i < params.length; i++) {
        var param = params[i].split('=')
        if (param[0] !== variable) {
            continue
        }
        return param[1]
    }

    return ''
}

function ajax(opt) {
    opt = opt || {};
    opt.method = !!opt.method === false ? 'POST' : opt.method.toUpperCase();
    opt.url = opt.url || '';
    opt.async = opt.async || true;
    opt.data = opt.data || null;
    opt.success = opt.success || function () {};
    var xhr = XMLHttpRequest ? new XMLHttpRequest() : new ActiveXObject('Microsoft.xhr');
    var params = [];

    for (var key in opt.data){
        params.push(encodeURIComponent(key) + '=' + encodeURIComponent(opt.data[key]));
    }

    let postData = params.join('&');

    if (opt.method.toUpperCase() === 'POST') {
        xhr.open(opt.method, opt.url, opt.async);
        xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded;charset=utf-8');
        xhr.send(postData);
    } else if (opt.method.toUpperCase() === 'GET') {
        xhr.open(opt.method, opt.url + '?' + postData, opt.async);
        xhr.send(null);
    }

    xhr.onreadystatechange = function () {
        if (xhr.readyState === 4 && xhr.status === 200) {
            let result = JSON.parse(xhr.responseText)
            opt.success(result);
        }
    }
}
</script>

</body>
</html>
