<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="format-detection" content="telephone=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <title>The9 Limited</title>
    <link rel="shortcut icon" href="favicon.ico" />
    <link rel="stylesheet" type="text/css" href="css/reset.css">
    <link rel="stylesheet" type="text/css" href="css/swiper-bundle.min.css">
    <!-- <link rel="stylesheet" type="text/css" href="css/layout.css"> -->
    <!-- <link rel="stylesheet" type="text/css" media="screen and (max-width: 549px)" href="css/iphone.css" /> -->
    <!-- <link rel="stylesheet" type="text/css" media="(min-width: 550px) and (max-width: 1024px)" href="css/ipad.css" /> -->
    <!-- <link rel="stylesheet" type="text/css" media="screen and (min-width: 1025px)" href="css/web.css" /> -->
    <script>
        // 给css增加时间戳解决缓存问题
        document.write(
                '<link rel = "stylesheet" href = "css/layout.css?time=' + new Date().getTime() + '" >',
                '<link rel = "stylesheet" media="screen and (max-width: 549px)" href="css/iphone.css?time=' + new Date().getTime() + '" >',
                '<link rel = "stylesheet" media="(min-width: 550px) and (max-width: 1024px)" href="css/ipad.css?time=' + new Date().getTime() + '" >',
                '<link rel = "stylesheet" media="screen and (min-width: 1025px)" href="css/web.css?time=' + new Date().getTime() + '" >'
            )
            // 百度统计
        var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?d00021e7896864443bf50ea538e817b8";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
        // if (sessionStorage.getItem("isReload")) {
        //     console.log("页面被刷新");
        // } else {
        //     console.log("首次被加载");
        //     sessionStorage.setItem("isReload", true)

        //     //根据浏览器语言判断显示中英文
        //     var type = navigator.appName
        //     console.log(type)
        //     if (type == "Netscape") {
        //         var lang = navigator.language
        //     } else {
        //         var lang = navigator.userLanguage
        //     }
        //     console.log(lang)
        //     if (lang == "zh-CN") {
        //         window.location.replace('https://www.the9.com/cn/')
        //     } else {
        //         window.location.replace('https://www.the9.com/')
        //     }
        // }
    </script>
</head>

<body>
    <!-- banner  begin -->
    <div class="swiper-container">
        <div class="swiper-wrapper">
            <!-- 此处增加复制swiper-slide的div，改动img的名字和新闻链接最后一个数字，并删除最后一个div.swiper-slide -->
            <div class="swiper-slide">
                <a href="http://www.the9.com/news-detial.html?act=new&articleId=603"><img src="images/1920en603.jpg" />
                </a>
            </div>
            <div class="swiper-slide">
                <a href="http://www.the9.com/news-detial.html?act=new&articleId=588"><img src="images/1920en588.jpg" />
                </a>
            </div>
            <div class="swiper-slide">
                <a href="http://www.the9.com/news-detial.html?act=new&articleId=582"><img src="images/1920en582.jpg" />
                </a>
            </div>
            <div class="swiper-slide">
                <a href="http://www.the9.com/news-detial.html?act=new&articleId=580"><img src="images/1920en580.jpg" />
                </a>
            </div>
            <div class="swiper-slide">
                <a href="http://www.the9.com/news-detial.html?act=new&articleId=578"><img src="images/1920en57801.jpg" />
                </a>
            </div>

        </div>
        <!-- 如果需要分页器 -->
        <div class="swiper-pagination"></div>

        <!-- 如果需要导航按钮 -->
        <div class="swiper-button-prev"></div>
        <div class="swiper-button-next"></div>
    </div>
    <div class="hot-content">
        <span href="javascript:;" class="prev"></span>
        <span href="javascript:;" class="next"></span>
        <ul class="hot-video">

        </ul>
    </div>
    <!-- hot-news   begin -->
    <div class="hot-news">
        <h2>
            <span class="fr"><a href="news-list.html?act=new">More ></a></span>
            <strong><em>N</em>ews</strong>
        </h2>
    </div>
    <!-- hot-news  end -->
    <!-- ad-banner  begin -->
    <script type="text/javascript" src="js/jquery.js"></script>
    <script type="text/javascript" src="js/jquery.xdomainrequest.min.js"></script>
    <script type="text/javascript" src="js/swiper-bundle.min.js"></script>
    <!-- <script type="text/javascript" src="js/template2.js?t='+ new Date().getTime() + '"></script> -->
    <script>
        document.write('<script src="js/template2.js?t=' + new Date().getTime() + '"><\/script>')
    </script>
    <script type="text/javascript">
        window.onload = function() {

            // 视频推荐滚动效果
            var preInow = 0;
            var showNum = 0;
            if ($(window).width() < 550) {
                showNum = 2
            } else if (550 < $(window).width() && $(window).width() < 1000) {
                showNum = 3
            } else {
                showNum = 5
            }

            var parent = $('.hot-content'),
                oUl = $('.hot-video'),
                aLi = $('.hot-video li');

            $('.next').click(function() {
                preInow++;
                if (preInow >= aLi.length - showNum) {
                    preInow = aLi.length - showNum;
                }
                tab();
            });

            $('.prev').click(function() {
                preInow--;
                if (preInow <= 0) {
                    preInow = 0;
                }
                tab();
            });

            var activePrent = parent.get(0);
            activePrent.addEventListener('touchstart', touch, false);
            activePrent.addEventListener('touchmove', move, false);

            var disX = 0;
            var tabBtn = true;
            var tabPrevBtn = true;

            function touch(e) {
                var ev = e.changedTouches[0];
                disX = ev.clientX;
            }

            function move(e) {
                var ev = e.changedTouches[0];
                if (ev.clientX < disX && tabBtn) {
                    tabBtn = false;
                    preInow++;
                    if (preInow >= aLi.length - showNum) {
                        preInow = aLi.length - showNum;
                    }
                    tab();
                }
                if (ev.clientX > disX && tabPrevBtn) {
                    tabPrevBtn = false;
                    preInow--;
                    if (preInow <= 0) {
                        preInow = 0;
                    }
                    tab();
                }
            }

            function tab() {
                oUl.stop().animate({
                    'left': -preInow * aLi.width()
                }, function() {
                    tabBtn = true;
                    tabPrevBtn = true;
                });
            }

            //视频推荐高度
            $(window).resize(function() {
                var hotImg = $('.hot-video').find('img').height();
                $('.hot-content').css('height', hotImg);
            })
            var hotImg = $('.hot-video').find('img').height();
            $('.hot-content').css('height', hotImg);
            // http://api.cms.the9.com/news/article
            jsonAjax('//apicms.the9.com/news/article', {
                page: 1,
                categoryId: 36,
                size: 5
            }, idxnewlistback);
            // 首页banner改动轮播图
            var mySwiper = new Swiper('.swiper-container', {
                direction: 'vertical', // 垂直切换选项
                loop: true, // 循环模式选项
                autoplay: true,
                // 如果需要前进后退按钮
                navigation: {
                    nextEl: '.swiper-button-next',
                    prevEl: '.swiper-button-prev',
                },
                effect: 'fade',
                fadeEffect: {
                    crossFade: true,
                }
            })
            var oBanner = $('.swiper-container');
            var oAdImg = $('.swiper-container img');
            var oAdImgH = oAdImg.height()
            oBanner.height(oAdImgH)
            console.log(oAdImgH)



            // 不同屏幕宽度下字数限制
            var wWidth = $(window).width();
            var txtNum = 0;
            if (wWidth > 1000) {
                txtNum = 400;
            } else if (wWidth < 1000 && wWidth > 800) {
                txtNum = 360;
            } else if (wWidth < 800 && wWidth > 500) {
                txtNum = 200;
            } else {
                txtNum = 150;
            }

            // 加载不同轮播图
            if (wWidth > 1000) {
                // pcCarousel();
            } else {
                //获取html
                var html = document.documentElement;
                //设置html的字体大小 = 可视区的宽度 / 15
                html.style.fontSize = html.clientWidth / 15 + 'px';
                //阻止pc和浏览器默认行为。
                // document.addEventListener('touchstart',function(ev){
                // 	ev.preventDefault();
                // });

                // var carousel = new Carousel();

                // carousel.init();
            }

            // ajax数据
            function idxnewlistback(data) {
                console.log('首页', data)
                var str = '',
                    data = data.data.articles;
                console.log(data)
                for (var i = 0; i < data.length; i++) {
                    if (data[i].articleId == 241) {
                        data.splice(i, 1);
                        continue;
                    } else if (i == 5) {
                        console.log('有五个！');
                        data.splice(i, 1);
                        continue;
                    }
                };

                // $.each(data, function (n, val) {
                // 	console.log(val.articleId);
                // 	if(val.articleId == 241) {
                // 		data.splice(n, 1);
                // 		continue;
                // 	}else if(n == 5){
                // 		data.splice(n, 1);
                // 		continue;
                // 	}
                // });

                // console.log(data)
                $.each(data, function(n, val) {

                    var formattingTxt = (val.content).replace(/<.*?>/ig, "").replace(/&nbsp;/ig, "")
                        // console.log((val.content))
                        // console.log(formattingTxt.substring(0, formattingTxt.indexOf('互')) + ' ———— ' + formattingTxt.substring(formattingTxt.indexOf('互'), formattingTxt.length))
                    str += '<div class="module">\
							<a href="news-detial.html?act=new&articleId=' + val.articleId + '">\
								<p>' + val.articleTitle + '<span class="fr">' + val.time + '</span></p>\
								<dl>';
                    // str += '<dd class="fl over-txt nopic">' + formattingTxt.substring(0, formattingTxt.indexOf(
                    //         'The9')) + ' —— ' + formattingTxt.substring(formattingTxt.indexOf('The9'), formattingTxt
                    //         .length),
                    //     txtNum + '</dd>';
                    str += '<dd class="fl over-txt nopic">' + val.introduction + '</dd>';
                    str += '</dl>\
							</a>\
						</div>';
                });
                $('.hot-news h2').after(str);
            }

            function openDtl(num) {
                sessionStorage.setItem('txtId', num);
            }

            function cutstr(str, len) {
                var str_length = 0;
                var str_len = 0;
                str_cut = new String();
                str_len = str.length;
                for (var i = 0; i < str_len; i++) {
                    a = str.charAt(i);
                    str_length++;
                    if (escape(a).length > 4) {
                        //中文字符的长度经编码之后大于4
                        str_length++;
                    }
                    str_cut = str_cut.concat(a);
                    if (str_length >= len) {
                        str_cut = str_cut.concat("...");
                        return str_cut;
                    }
                }
                //如果给定字符串小于指定长度，则返回源字符串；
                // if (str_length <script script script script len) {
                //     return str;
                // }
            }
        }
    </script>
</body>

</html>